"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[505],{89505:(e,a,t)=>{t.r(a),t.d(a,{default:()=>c});var s=t(95155),r=t(12115),l=t(69253);let c=()=>{let[e,a]=(0,r.useState)([]),[t,c]=(0,r.useState)([]),[o,d]=(0,r.useState)(null),[n,i]=(0,r.useState)(!1),[m,p]=(0,r.useState)(""),h=Array(9).fill({player_id:"",goals:0}),[u,y]=(0,r.useState)({match_date:new Date().toISOString().split("T")[0],team_a:[...h],team_b:[...h],team_a_score:0,team_b_score:0});(0,r.useEffect)(()=>{x(),_()},[]);let x=async()=>{try{let e=await fetch("/api/admin/players"),t=await e.json();console.log("Fetched players:",t.data),t.data&&a(t.data.filter(e=>!e.is_retired))}catch(e){console.error("Error fetching players:",e),p("Failed to fetch players")}},_=async()=>{try{let e=await fetch("/api/admin/matches"),a=await e.json();console.log("Fetched matches:",a.data),a.data?Array.isArray(a.data)?c(a.data):(console.error("Invalid matches data:",a.data),p("Invalid matches data received")):(console.error("No matches data found:",a),p("No matches data found"))}catch(e){console.error("Error fetching matches:",e),p("Failed to fetch matches")}},b=(e,a,t,s)=>{let r=[...u["team_".concat(e)]];r[a]={...r[a],[t]:s},y({...u,["team_".concat(e)]:r})},g=()=>{let e=u.team_a.reduce((e,a)=>e+(parseInt(a.goals)||0),0),a=u.team_b.reduce((e,a)=>e+(parseInt(a.goals)||0),0);if(e!==parseInt(u.team_a_score)||a!==parseInt(u.team_b_score)){let t="The total goals scored by players do not match the team scores.\n\n"+"Team A: Players scored ".concat(e," goals, but the team score is ").concat(u.team_a_score,".\n")+"Team B: Players scored ".concat(a," goals, but the team score is ").concat(u.team_b_score,".\n\n")+"Do you want to save anyway?";return window.confirm(t)}let t=[...u.team_a.map(e=>e.player_id),...u.team_b.map(e=>e.player_id)].filter(e=>e);return new Set(t).size===t.length||(p("A player cannot be in both teams"),!1)},f=async e=>{if(e.preventDefault(),g()){i(!0),p("");try{let e=[...u.team_a.map(e=>({...e,team:"A",player_id:parseInt(e.player_id)})),...u.team_b.map(e=>({...e,team:"B",player_id:parseInt(e.player_id)}))].filter(e=>e.player_id),a={match_date:u.match_date,team_a_score:parseInt(u.team_a_score),team_b_score:parseInt(u.team_b_score),players:e};o&&(a.match_id=o.match_id);let t=o?"PUT":"POST";console.log("Sending match data:",a);let s=await fetch("/api/admin/matches",{method:t,headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),r=await s.json();if(r.error)throw Error(r.error);y({match_date:new Date().toISOString().split("T")[0],team_a:[...h],team_b:[...h],team_a_score:0,team_b_score:0}),d(null),_()}catch(e){console.error("Error updating match:",e),p(e.message)}finally{i(!1)}}},j=e=>{d(e);let a=Array(9).fill({player_id:"",goals:0}),t=Array(9).fill({player_id:"",goals:0});e.player_matches.forEach(e=>{let s="A"===e.team?a:t,r=s.findIndex(e=>!e.player_id);-1!==r&&(s[r]={player_id:e.player_id,goals:e.goals})}),y({match_date:new Date(e.match_date).toISOString().split("T")[0],team_a:a,team_b:t,team_a_score:e.team_a_score,team_b_score:e.team_b_score})};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold",children:o?"Edit Match":"Add New Match"}),(0,s.jsxs)("form",{onSubmit:f,className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Match Date"}),(0,s.jsx)("input",{type:"date",value:u.match_date,onChange:e=>y({...u,match_date:e.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h3",{className:"text-lg font-medium",children:"Team A"}),u.team_a.map((a,t)=>(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,s.jsx)("div",{className:"col-span-2",children:(0,s.jsxs)("select",{value:a.player_id,onChange:e=>b("a",t,"player_id",e.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[(0,s.jsx)("option",{value:"",children:"Select Player"}),e.map(e=>(0,s.jsx)("option",{value:e.player_id,children:e.name},e.player_id))]})}),(0,s.jsx)("input",{type:"number",min:"0",value:a.goals,onChange:e=>b("a",t,"goals",parseInt(e.target.value)||0),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]},"team-a-".concat(t))),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Team A Score"}),(0,s.jsx)("input",{type:"number",min:"0",value:u.team_a_score,onChange:e=>y({...u,team_a_score:parseInt(e.target.value)||0}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h3",{className:"text-lg font-medium",children:"Team B"}),u.team_b.map((a,t)=>(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,s.jsx)("div",{className:"col-span-2",children:(0,s.jsxs)("select",{value:a.player_id,onChange:e=>b("b",t,"player_id",e.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[(0,s.jsx)("option",{value:"",children:"Select Player"}),e.map(e=>(0,s.jsx)("option",{value:e.player_id,children:e.name},e.player_id))]})}),(0,s.jsx)("input",{type:"number",min:"0",value:a.goals,onChange:e=>b("b",t,"goals",parseInt(e.target.value)||0),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]},"team-b-".concat(t))),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Team B Score"}),(0,s.jsx)("input",{type:"number",min:"0",value:u.team_b_score,onChange:e=>y({...u,team_b_score:parseInt(e.target.value)||0}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]})]})]}),m&&(0,s.jsx)("div",{className:"text-red-500 text-sm",children:m}),(0,s.jsxs)("div",{className:"flex space-x-4",children:[(0,s.jsx)("button",{type:"submit",disabled:n,className:"px-4 py-2 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg hover:from-purple-600 hover:to-blue-500 transition-all disabled:opacity-50",children:n?"Saving...":o?"Update Match":"Add Match"}),o&&(0,s.jsx)("button",{type:"button",onClick:()=>{d(null),y({match_date:new Date().toISOString().split("T")[0],team_a:[...h],team_b:[...h],team_a_score:0,team_b_score:0})},className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-all",children:"Cancel Edit"})]})]}),(0,s.jsxs)("div",{className:"mt-8",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"Previous Matches"}),(0,s.jsx)("div",{className:"bg-white shadow overflow-hidden rounded-lg",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Score"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Players"}),(0,s.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:t&&t.map(e=>e&&e.player_matches?(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,l.GP)(new Date(e.match_date),"MM/dd/yyyy")}),(0,s.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.team_a_score," - ",e.team_b_score]}),(0,s.jsx)("td",{className:"px-6 py-4",children:(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsxs)("div",{children:["Team A: ",e.player_matches.filter(e=>"A"===e.team&&e.players).map(e=>e.players.name).join(", ")]}),(0,s.jsxs)("div",{children:["Team B: ",e.player_matches.filter(e=>"B"===e.team&&e.players).map(e=>e.players.name).join(", ")]})]})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,s.jsx)("button",{onClick:()=>j(e),className:"text-blue-600 hover:text-blue-900",children:"Edit"})})]},e.match_id):(console.error("Invalid match data:",e),null))})]})})]})]})}}}]);